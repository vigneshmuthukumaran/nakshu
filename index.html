<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Nakshatra's Checklist</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- load handwritten fonts from Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Patrick+Hand&family=Caveat:wght@400;700&display=swap" rel="stylesheet">
    <style>
        html, body { height: 100%; }
        body {
            /* handwritten-first font stack with sensible fallbacks */
            font-family: "Patrick Hand", "Caveat", "Shadows Into Light", -apple-system, system-ui, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            margin: 20px;
            background-color: #f0f0f0;
        }

        h1 { color: #333; text-align: center; }
        ul { list-style: none; padding: 0; margin: 0 auto; max-width: 600px; }
        li {
            margin: 15px 0;
            display: flex;
            align-items: center;
            justify-content: space-between;
            background-color: #fff;
            padding: 10px;
            border-radius: 8px;
            flex-wrap: wrap;
        }
        .item-left { display:flex; align-items:center; flex:1; min-width:200px; }
        img { width:40px; height:40px; margin-right:15px; border-radius:5px; }

        .switch { position: relative; display:inline-block; width:50px; height:24px; }
        .switch input { opacity:0; width:0; height:0; }
        .slider {
            position:absolute; cursor:pointer; top:0; left:0; right:0; bottom:0;
            background-color:#ccc; transition:.4s; border-radius:24px;
        }
        .slider:before {
            position:absolute; content:""; height:18px; width:18px; left:3px; bottom:3px;
            background:#fff; transition:.4s; border-radius:50%;
        }
        input:checked + .slider { background-color:#4CAF50; }
        input:checked + .slider:before { transform:translateX(26px); }

        /* canvas (confetti) */
        #confetti-canvas {
            position: fixed; top:0; left:0; width:100%; height:100%;
            pointer-events:none; z-index:9998; display:block;
        }

        /* celebration overlay - full screen */
        .celebration-overlay {
            position: fixed; inset:0; display:none; align-items:center; justify-content:center;
            z-index:10000; pointer-events:none; overflow:hidden;
        }
        .celebration-overlay.active { display:flex; pointer-events:auto; }
        .celebration-bg {
            position:absolute; inset:0;
            background: linear-gradient(180deg, rgba(10,30,60,0.32), rgba(40,120,200,0.12));
            backdrop-filter: blur(3px); pointer-events:none;
        }
        .celebration-message {
            position:relative; z-index:10001; font-size:2.4rem; color:#fff;
            text-shadow:0 8px 30px rgba(0,0,0,0.45); text-align:center; pointer-events:none;
            transform: scale(0.95); animation: messagePop 700ms cubic-bezier(.2,.9,.2,1) forwards;
        }
        @keyframes messagePop {
            to { transform: scale(1); }
        }

        /* party shapes (full-screen celebration elements) */
        .party-shape {
            position:absolute; z-index:10002; pointer-events:none;
            border-radius: 14px;
            filter: drop-shadow(0 8px 18px rgba(0,0,0,0.25));
            will-change: transform, opacity, left, top;
            opacity: 0;
        }
        @keyframes shapePop {
            0%   { transform: translateY(20px) scale(0.6) rotate(0deg); opacity:0; }
            20%  { opacity:1; transform: translateY(0) scale(1.05) rotate(6deg); }
            50%  { transform: translateY(-10vh) scale(1) rotate(-6deg); }
            100% { transform: translateY(-140vh) scale(0.9) rotate(30deg); opacity:0; }
        }
        @keyframes shimmer {
            0% { transform: translateX(0); }
            50% { transform: translateX(16px); }
            100% { transform: translateX(0); }
        }

        .celebration-close {
            position:absolute; top:18px; right:18px; z-index:10003;
            background: rgba(0,0,0,0.45); color:#fff; border:none; padding:8px 12px;
            border-radius:8px; cursor:pointer; display:none; pointer-events:auto;
        }
        .celebration-overlay.active .celebration-close { display:block; }

        /* simple clock widget (fixed top-left) - original look */
        .clock-widget {
            position: fixed;
            top: 12px;
            left: 12px;
            z-index: 11000;
            background: rgba(255,255,255,0.95);
            color: #0b3d91;
            padding: 8px 12px;
            border-radius: 10px;
            box-shadow: 0 6px 18px rgba(10,20,40,0.12);
            font-weight: 600;
            font-size: 14px;
            font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
            pointer-events: none;
            display: inline-flex;
            align-items: baseline;
            gap: 8px;
        }
        .clock-widget .time {
            font-size: 16px;
            letter-spacing: 0.6px;
        }
        .clock-widget .tz {
            font-size: 11px;
            color: rgba(11,61,145,0.7);
        }

        @media (max-width:420px){
            .clock-widget{ left:8px; top:8px; padding:6px 8px; font-size:13px; }
            .clock-widget .time{ font-size:14px; }
        }

        /* Classic alarm-style clock widget (digital IST time) */
        .alarm-frame {
            position: relative;
            width: 100%;
            height: 100%;
            background: linear-gradient(180deg,#f7e7c2 0%, #f2d58a 60%);
            border: 4px solid #a46c00;
            border-radius: 12px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.25), inset 0 -6px 18px rgba(255,255,255,0.18);
            overflow: visible;
        }
        .bell {
            position: absolute;
            top: -10px;
            width: 28px;
            height: 18px;
            background: linear-gradient(180deg,#ffd87a,#ffcc4d);
            border: 3px solid #a46c00;
            border-radius: 12px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.18);
        }
        .bell.left { left: 10%; transform: translateX(-50%); }
        .bell.right { right: 10%; transform: translateX(50%); }

        .digital-display {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%,-50%);
            font-size: 1.4rem;
            color: #5a3300;
            font-weight: 700;
            letter-spacing: 0.6px;
            background: rgba(255,255,255,0.6);
            padding: 4px 12px;
            border-radius: 8px;
            white-space: nowrap;
        }
        .clock-tz {
            display: none !important; /* hide timezone label */
        }
    </style>
</head>
<body>
    <!-- simple clock widget (original) -->
    <div id="clock" class="clock-widget" role="timer" aria-live="polite" aria-atomic="true">
        <div class="time" id="clockTime">--:--:--</div>
        <div class="tz">IST</div>
    </div>

    <h1>Nakshatra's Super Daily Routine!</h1>
    <ul>
        <li>
            <div class="item-left">
                <img src="images/1.jpeg" alt="Item 1">
                <span>The Daily Flush Mission! Let's get that morning duty done!</span>
            </div>
            <label class="switch"><input type="checkbox"><span class="slider"></span></label>
        </li>
        <li>
            <div class="item-left">
                <img src="https://via.placeholder.com/40" alt="Item 2">
                <span>Monster Alert! Brush those teeth before the dragons come !!!</span>
            </div>
            <label class="switch"><input type="checkbox"><span class="slider"></span></label>
        </li>
        <li>
            <div class="item-left">
                <img src="https://via.placeholder.com/40" alt="Item 3">
                <span>Rub-a-dub-dub! Time for a bath to get rid of the dirt and grime!</span>
            </div>
            <label class="switch"><input type="checkbox"><span class="slider"></span></label>
        </li>
        <li>
            <div class="item-left">
                <img src="https://via.placeholder.com/40" alt="Item 4">
                <span>Dino-Mite Blow Dry! Roar with a hot air blast and tame that mane!</span>
            </div>
            <label class="switch"><input type="checkbox"><span class="slider"></span></label>
        </li>
        <li>
            <div class="item-left">
                <img src="https://via.placeholder.com/40" alt="Item 5">
                <span>Lotion Party! Let's get your skin dancing with happiness!</span>
            </div>
            <label class="switch"><input type="checkbox"><span class="slider"></span></label>
        </li>
        <li>
            <div class="item-left">
                <img src="https://via.placeholder.com/40" alt="Item 6">
                <span>The Daily Dress-Up Challenge! Get ready to rock that school look!</span>
            </div>
            <label class="switch"><input type="checkbox"><span class="slider"></span></label>
        </li>
        <li>
            <div class="item-left">
                <img src="https://via.placeholder.com/40" alt="Item 7">
                <span>Heart-to-Heart with God! Let's have a special conversation!</span>
            </div>
            <label class="switch"><input type="checkbox"><span class="slider"></span></label>
        </li>
        <li>
            <div class="item-left">
                <img src="https://via.placeholder.com/40" alt="Item 8">
                <span>Breakfast Rocket Fuel! Blast off into a fantastic day!</span>
            </div>
            <label class="switch"><input type="checkbox"><span class="slider"></span></label>
        </li>
        <li>
            <div class="item-left">
                <img src="https://via.placeholder.com/40" alt="Item 9">
                <span>Mosquito Shield Activate! Let's protect you from those pesky buzzers!</span>
            </div>
            <label class="switch"><input type="checkbox"><span class="slider"></span></label>
        </li>
        <li>
            <div class="item-left">
                <img src="https://via.placeholder.com/40" alt="Item 10">
                <span>Sunscreen Superpower! Save your skin from those sneaky UV rays!</span>
            </div>
            <label class="switch"><input type="checkbox"><span class="slider"></span></label>
        </li>
        <li>
            <div class="item-left">
                <img src="https://via.placeholder.com/40" alt="Item 11">
                <span>Sole Mates! Let's find your shoes and get them on for an amazing day!</span>
            </div>
            <label class="switch"><input type="checkbox"><span class="slider"></span></label>
        </li>
        <li>
            <div class="item-left">
                <img src="https://via.placeholder.com/40" alt="Item 12">
                <span>Kiss Attack! Give a big hug and kiss before you conquer the classroom!</span>
            </div>
            <label class="switch"><input type="checkbox"><span class="slider"></span></label>
        </li>
    </ul>

    <canvas id="confetti-canvas" aria-hidden="true"></canvas>

    <div id="celebration" class="celebration-overlay" aria-hidden="true">
        <div class="celebration-bg" aria-hidden="true"></div>
        <div class="celebration-message" id="celebrationMessage">Hooray! You did it! 🎉</div>
        <button class="celebration-close" id="celebrationClose" aria-label="Close celebration">Close</button>
    </div>

    <script>
    (function(){
        const canvas = document.getElementById('confetti-canvas');
        const ctx = canvas.getContext('2d');
        let DPR = Math.max(1, window.devicePixelRatio || 1);
        let W = 0, H = 0;
        function resize() {
            DPR = Math.max(1, window.devicePixelRatio || 1);
            W = canvas.clientWidth * DPR;
            H = canvas.clientHeight * DPR;
            canvas.width = W;
            canvas.height = H;
            ctx.setTransform(1,0,0,1,0,0);
            ctx.scale(DPR, DPR);
        }
        function syncCanvasSize() {
            canvas.style.width = '100%';
            canvas.style.height = '100%';
            resize();
        }
        syncCanvasSize();
        window.addEventListener('resize', syncCanvasSize);

        const colors = ['#e74c3c','#f1c40f','#2ecc71','#3498db','#9b59b6','#f39c12','#ff7fa1','#7ee3a7'];
        let particles = [];
        let running = false;

        function rand(min, max){ return Math.random()*(max-min)+min; }

        function spawnConfetti(clientX, clientY, count = 40){
            const rect = canvas.getBoundingClientRect();
            const x = clientX - rect.left;
            const y = clientY - rect.top;
            for(let i=0;i<count;i++){
                particles.push({
                    x: x,
                    y: y,
                    vx: rand(-8, 8),
                    vy: rand(-14, -6),
                    size: rand(6, 14),
                    color: colors[Math.floor(rand(0, colors.length))],
                    rot: rand(0, Math.PI*2),
                    rotSpeed: rand(-0.25, 0.25),
                    life: rand(80, 160),
                    ttl: 0
                });
            }
            if(!running){ running = true; requestAnimationFrame(loop); }
        }

        function loop(){
            ctx.clearRect(0,0,canvas.width, canvas.height);
            for(let i = particles.length-1; i >= 0; i--){
                const p = particles[i];
                p.ttl++;
                p.vy += 0.35;
                p.vx *= 0.995;
                p.x += p.vx;
                p.y += p.vy;
                p.rot += p.rotSpeed;

                ctx.save();
                ctx.translate(p.x, p.y);
                ctx.rotate(p.rot);
                ctx.fillStyle = p.color;
                ctx.fillRect(-p.size/2, -p.size/2, p.size, p.size*0.6);
                ctx.restore();

                if(p.ttl > p.life || p.y > window.innerHeight + 60){
                    particles.splice(i,1);
                }
            }
            if(particles.length > 0){
                requestAnimationFrame(loop);
            } else {
                running = false;
            }
        }

        // checklist
        const checkboxes = Array.from(document.querySelectorAll('.switch input[type="checkbox"]'));
        checkboxes.forEach(cb => {
            cb.addEventListener('change', (e) => {
                const rect = e.target.getBoundingClientRect();
                const cx = rect.left + rect.width/2;
                const cy = rect.top + rect.height/2;
                spawnConfetti(cx, cy, 36);
                setTimeout(checkAllAndCelebrate, 40);
            });
        });

        // celebration logic (full-screen shapes + confetti + music)
        const celebration = document.getElementById('celebration');
        const celebrationClose = document.getElementById('celebrationClose');
        let celebrationActive = false;
        let audioCtx = null;

        function checkAllAndCelebrate(){
            if (celebrationActive) return;
            const all = checkboxes.length > 0 && checkboxes.every(cb => cb.checked);
            if(all){
                celebrationActive = true;
                triggerCelebration();
            }
        }

        function triggerCelebration(){
            syncCanvasSize();
            celebration.classList.add('active');
            celebration.setAttribute('aria-hidden','false');

            // several full-screen confetti bursts
            const bursts = 14;
            for(let i=0;i<bursts;i++){
                setTimeout(() => {
                    const x = rand(30, window.innerWidth - 30);
                    const y = rand(40, window.innerHeight/2);
                    spawnConfetti(x, y, 28 + Math.round(rand(0,40)));
                }, i * 140);
            }

            // spawn lots of full-screen animated shapes (covering whole viewport)
            spawnPartyShapes(34);

            // play melody
            playMelody();

            // allow closing
            celebrationClose.addEventListener('click', endCelebration, { once: true });
            setTimeout(endCelebration, 11000);
        }

        function endCelebration(){
            celebration.classList.remove('active');
            celebration.setAttribute('aria-hidden','true');
            // remove shapes
            document.querySelectorAll('.party-shape').forEach(n => n.remove());
            // clear confetti particles; let loop naturally stop
            particles = [];
            setTimeout(() => { celebrationActive = false; }, 1200);
        }

        // spawn full-screen colorful animated shapes
        function spawnPartyShapes(count){
            const palette = ['#ff7fa1','#ffd27a','#7ee3a7','#7fb3ff','#c98cff','#ffd2e6','#fff68a'];
            for(let i=0;i<count;i++){
                const s = document.createElement('div');
                s.className = 'party-shape';
                const size = Math.round(rand(48, 180));
                s.style.width = size + 'px';
                s.style.height = Math.round(size*0.6) + 'px';
                // random rounded shapes and sometimes circles
                s.style.borderRadius = Math.round(rand(8,50)) + 'px';
                const left = rand(-8, 92);
                const top = rand(10, 80);
                s.style.left = left + 'vw';
                s.style.top = top + 'vh';
                s.style.background = palette[Math.floor(rand(0, palette.length))];
                // random rotation and animation timing
                const dur = Math.round(rand(6000, 14000));
                const delay = Math.round(rand(0, 900));
                s.style.animation = `shapePop ${dur}ms cubic-bezier(.2,.9,.2,1) ${delay}ms forwards, shimmer ${Math.round(rand(2000,6000))}ms ease-in-out ${delay}ms infinite`;
                s.style.transform = `translateY(0) rotate(${Math.round(rand(-10,20))}deg)`;
                s.style.opacity = '0';
                celebration.appendChild(s);

                // remove after animation ends
                setTimeout(()=> s.remove(), dur + delay + 600);
            }

            // add a few larger centered bursts for visual punch
            const centerBurst = document.createElement('div');
            centerBurst.className = 'party-shape';
            centerBurst.style.width = '340px';
            centerBurst.style.height = '220px';
            centerBurst.style.left = '50%';
            centerBurst.style.top = '42%';
            centerBurst.style.transform = 'translateX(-50%)';
            centerBurst.style.borderRadius = '24px';
            centerBurst.style.background = 'linear-gradient(135deg,#ffd27a,#ff7fa1)';
            centerBurst.style.animation = `shapePop 3600ms cubic-bezier(.2,.9,.2,1) 120ms forwards, shimmer 3500ms ease-in-out 120ms infinite`;
            celebration.appendChild(centerBurst);
            setTimeout(()=> centerBurst.remove(), 4000);
        }

        // simple synthesized melody via WebAudio (no external files)
        function playMelody(){
            try {
                if(!audioCtx){
                    audioCtx = new (window.AudioContext || window.webkitAudioContext)();
                } else if(audioCtx.state === 'suspended') {
                    audioCtx.resume();
                }
            } catch (e) { return; }
            const now = audioCtx.currentTime;
            const master = audioCtx.createGain();
            master.gain.setValueAtTime(0.16, now);
            master.connect(audioCtx.destination);

            const notes = [ 440.00, 523.25, 659.25, 523.25, 440.00, 0, 440.00, 0 ];
            const durations = [0.16,0.18,0.22,0.18,0.36,0.06,0.6,0.4];
            let t = now + 0.05;
            for(let i=0;i<notes.length;i++){
                const f = notes[i], d = durations[i];
                if(f>0){
                    const o = audioCtx.createOscillator();
                    const g = audioCtx.createGain();
                    o.type = 'triangle';
                    o.frequency.setValueAtTime(f, t);
                    g.gain.setValueAtTime(0, t);
                    g.gain.linearRampToValueAtTime(0.9, t+0.02);
                    g.gain.exponentialRampToValueAtTime(0.001, t+d-0.02);
                    o.connect(g); g.connect(master);
                    o.start(t); o.stop(t+d);
                }
                t += d;
            }
            // final chord
            setTimeout(()=> {
                const chordTime = audioCtx.currentTime + 0.02;
                [330.00, 440.00, 523.25].forEach((f, idx) => {
                    const o = audioCtx.createOscillator();
                    const g = audioCtx.createGain();
                    o.type = idx===1?'sine':'triangle';
                    o.frequency.setValueAtTime(f, chordTime);
                    g.gain.setValueAtTime(0, chordTime);
                    g.gain.linearRampToValueAtTime(0.7, chordTime+0.02);
                    g.gain.exponentialRampToValueAtTime(0.001, chordTime+1.4);
                    o.connect(g); g.connect(master);
                    o.start(chordTime); o.stop(chordTime+1.4);
                });
            }, 900);
        }

        // close with Escape
        window.addEventListener('keydown', (e) => {
            if(e.key === 'Escape' && celebrationActive){
                endCelebration();
            }
        });

        // keep canvas sizing synced after initial load
        setTimeout(syncCanvasSize, 50);

        // Clock sourced from web (WorldTimeAPI) in IST (Asia/Kolkata).
        // Strategy: fetch authoritative server time once, then tick locally using performance.now() delta.
        // Periodically re-sync to correct drift.
        let serverTimeMs = null;
        let serverPerfNow = null;
        const CLOCK_EL = document.getElementById('clockTime');

        async function syncTimeFromServer(){
            try {
                const res = await fetch('https://worldtimeapi.org/api/timezone/Asia/Kolkata', { cache: 'no-cache' });
                if(!res.ok) throw new Error('Time API response not ok');
                const data = await res.json();
                // data.datetime is ISO string with offset, parse to ms
                if(data && data.datetime){
                    serverTimeMs = Date.parse(data.datetime);
                    serverPerfNow = performance.now();
                    // immediate display update after sync
                    updateClockDisplay();
                } else if (data && typeof data.unixtime === 'number') {
                    // fallback if API returns unixtime (seconds)
                    serverTimeMs = data.unixtime * 1000;
                    serverPerfNow = performance.now();
                    updateClockDisplay();
                } else {
                    throw new Error('Unexpected time API payload');
                }
            } catch (err) {
                console.warn('Time sync failed, will fallback to Intl/local calculation:', err);
                // clear serverTimeMs so updateClockDisplay uses fallback computation
                serverTimeMs = null;
                serverPerfNow = null;
                updateClockDisplay(); // immediate fallback display
            }
        }

        function getNowIstMs() {
            if (serverTimeMs !== null && serverPerfNow !== null) {
                // advance server time by elapsed high-res time
                return serverTimeMs + (performance.now() - serverPerfNow);
            }
            // fallback: compute IST from client's clock using timezone conversion (not preferred)
            try {
                const now = new Date();
                const parts = new Intl.DateTimeFormat('en-GB', { timeZone: 'Asia/Kolkata', hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: false }).formatToParts(now);
                const hh = parseInt(parts.find(p => p.type === 'hour').value, 10);
                const mm = parseInt(parts.find(p => p.type === 'minute').value, 10);
                const ss = parseInt(parts.find(p => p.type === 'second').value, 10);
                const d = new Date();
                d.setHours(hh, mm, ss, 0);
                return d.getTime();
            } catch (e) {
                // last resort: approximate IST by applying +5.5h to UTC
                const utc = Date.now() + (new Date()).getTimezoneOffset() * 60000;
                return utc + (5.5 * 3600000);
            }
        }

        function updateClockDisplay(){
            const nowMs = getNowIstMs();
            const d = new Date(nowMs);
            const hh = String(d.getHours()).padStart(2,'0');
            const mm = String(d.getMinutes()).padStart(2,'0');
            const ss = String(d.getSeconds()).padStart(2,'0');
            if (CLOCK_EL) CLOCK_EL.textContent = `${hh}:${mm}:${ss}`;
        }

        // initial sync and then update every second.
        syncTimeFromServer();
        setInterval(updateClockDisplay, 1000);
        // re-sync from server every 15 minutes to correct drift
        setInterval(syncTimeFromServer, 15 * 60 * 1000);
     })();
     </script>
</body>
</html>